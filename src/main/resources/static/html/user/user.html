<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge，chrome=1">
    <title>用户中心</title>
    <link rel="stylesheet" href="/static/css/common/imagehover.min.css">
    <link rel="stylesheet" href="/static/css/user/user.css">
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
</head>
<body>
<nav id="header" style="min-width: 1024px "></nav>
<main style="min-width: 1024px ">
    <div class="layui-container layui-anim layui-anim-upbit" style="min-width: 1024px ">
        <div class="lay-row">
            <div class="user-baseinfo">
                <div class="background">
                    <img src="/static/img/user/photo-147.png" alt="" class="background-img">
                </div>
                <div class="layui-col-md3 time-container" style="position: relative;top: 70%;left: 100px">
                    <div class="base">
                        <img src="" alt=""
                             style="width: 90px;height: 90px;background-color: #0F9E5E;float: left;border-radius:50px">
                        <div class="base-name" style="position: relative;left: 20px;top: 23px;font-weight:bold">Lomo
                            Fu
                        </div>
                    </div>
                </div>
                <div class="layui-col-md-offset9 time-container"
                     style="position: relative;top: 72%;left: 100px;width:12%">
                    <div class="detail">
                        <div class="collectCount">收藏数: 999</div>
                        <div class="collectCount">回复数: 0</div>
                        <div class="collectCount">关注数: 0</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="lay-row layui-col-space15" style="clear: both;position: relative;top: 50px">
            <div class="layui-col-md8">
                <div class="layui-tab layui-tab-card" style="width: 722px">
                    <ul class="layui-tab-title" style="background: #96a48b;color: white">
                        <li class="layui-this">我的影评</li>
                        <li>我的评论</li>
                        <li>我的关注</li>
                        <li>我的收藏</li>
                        <li>回复我的</li>
                    </ul>
                    <div class="layui-tab-content" style="height: 100%;background: white">
                        <div class="layui-tab-item layui-show layui-anim layui-anim-upbit" id="myComment">
                            <ul class="layui-timeline" style="margin-top: 20px">
                            </ul>
                        </div>
                        <div class="layui-tab-item layui-anim layui-anim-upbit" id="myReply">
                            <ul class="layui-timeline" style="margin-top: 20px">
                            </ul>
                        </div>
                        <div class="layui-tab-item layui-anim layui-anim-upbit">
                            <ul class="layui-timeline" style="margin-top: 20px">
                            </ul>
                        </div>
                        <div class="layui-tab-item layui-anim layui-anim-upbit">
                            <ul class="layui-timeline" style="margin-top: 20px">
                            </ul>
                        </div>
                        <div class="layui-tab-item layui-anim layui-anim-upbit" id="reply">
                            <ul class="layui-timeline" style="margin-top: 20px">
                            </ul>
                        </div>
                        <div class="layui-tab-item layui-anim layui-anim-upbit">6</div>
                    </div>
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-card" style="margin-top: 10px">
                    <div class="layui-card-header" style="text-align: center;background: #d8caaf;color: white">最近关注
                    </div>
                    <div class="layui-card-body">
                        卡片式面板面板通常用于非白色背景色的主体内<br>
                        从而映衬出边框投影
                        卡片式面板面板通常用于非白色背景色的主体内<br>
                        从而映衬出边框投影
                        从而映衬出边框投影
                        从而映衬出边框投影
                        从而映衬出边框投影
                        从而映衬出边框投影
                        从而映衬出边框投影
                    </div>
                </div>
                <br>
                <div class="layui-card">
                    <div class="layui-card-header" style="text-align: center;background: #9ca8b8;color: white">最近关注
                    </div>
                    <div class="layui-card-body">
                        卡片式面板面板通常用于非白色背景色的主体内<br>
                        从而映衬出边框投影
                        卡片式面板面板通常用于非白色背景色的主体内<br>
                        从而映衬出边框投影
                        从而映衬出边框投影
                        从而映衬出边框投影
                        从而映衬出边框投影
                        从而映衬出边框投影
                        从而映衬出边框投影
                    </div>
                </div>
            </div>
        </div>
        <div style="height:1px; margin-top:-1px;clear: both;overflow:hidden;"></div>
    </div>
</main>
<footer id="footer"></footer>
<script src="/static/layui/layui.all.js"></script>
<script>
    $ = layui.$;
    $("#footer").load("/footer");
    $("#header").load("/nav");
    const util = layui.util;
    let time;
    util.fixbar({
        showHeight: 100
    });

    $('.background-img').mouseenter(() => {
        $('.background-img').css('transform', 'scale(1.06)');
        $('.background-img').css('filter', 'blur(5px) brightness(80%)');
    });

    $('.background-img').mouseleave(() => {
        time = setTimeout(() => {
            $('.background-img').css('transform', 'scale(1)');
            $('.background-img').css('filter', 'blur(0px) brightness(100%)');
        }, 100);
    });
    $('.time-container').mouseenter(() => {
        clearTimeout(time);
    })
    $.get("/api/comment/userid", {userId: 1004}, (data) => {
        let res = data.data;
        $.each(res, function (index, item) {
            $("#myComment ul").append("  <li class=\"layui-timeline-item\"> <i class=\"layui-icon layui-timeline-axis\">&#xe63f;</i> <div class=\"layui-timeline-content layui-text\"> <h3 class=\"layui-timeline-title\">" + new Date(item.createTime).getFullYear() + "年" + new Date(item.createTime).getMonth() + "月" + new Date(item.createTime).getDay() + "日" + "</h3> <p>" + item.content + " </p> <button id='del' onclick='deleter(this)' value='"+item.movieId+"'>删除</button> </div> </li>");
        });
    });
    $.get("/api/reply/userId/1004", (data) => {
        let res = data.data;
        $.each(res, function (index, item) {
            $("#myReply ul").append("  <li class=\"layui-timeline-item\"> <i class=\"layui-icon layui-timeline-axis\">&#xe63f;</i> <div class=\"layui-timeline-content layui-text\"> <h3 class=\"layui-timeline-title\">" + new Date(item.createTime).getFullYear() + "年" + new Date(item.createTime).getMonth() + "月" + new Date(item.createTime).getDay() + "日" + "</h3> <p>" + item.rcontent + " </p> </div> </li>");
        });
    });
    $.get("/api/reply/parentId//1004", (data) => {
        let res = data.data;
        $.each(res, function (index, item) {
            $("#reply ul").append("  <li class=\"layui-timeline-item\"> <i class=\"layui-icon layui-timeline-axis\">&#xe63f;</i> <div class=\"layui-timeline-content layui-text\"> <h3 class=\"layui-timeline-title\">" + new Date(item.createTime).getFullYear() + "年" + new Date(item.createTime).getMonth() + "月" + new Date(item.createTime).getDay() + "日" + "</h3> <p>" + item.rcontent + " </p></div> </li>");
        });
    });

    function deleter(element) {
        let movieId = element.value;
        layer.confirm('您确定要删除此评论？', {
            btn: ['是的', '再想想']
        }, function () {
            //确定的方法
            $.get("/api/comment/delete",{ 'userId': 1004,'movieId': movieId },
                function (data) {
                    if (data.code == 200) {
                        layer.msg(data.msg, {
                            icon: 1, time: 1000, end: function () {
                                location.reload();
                            }
                        });
                    } else {
                        layer.msg(data.msg, {icon: 2});

                    }
                });
        }, function () {
            layer.closeAll();
        });

    }
</script>
</body>
</html>